# FIFO数据解析模块验证计划

## 1. 概述
本验证计划针对FIFO数据解析模块(`fifo_data_resolu`)，验证其将140位输入数据解析为128位格雷码、8位通道有效信号和16位数据计数的功能正确性。测试平台通过实时比对DUT与参考模型输出来确保功能一致性。

## 2. 验证目标
- 验证数据解析的正确性（140位→128位格雷码）
- 验证通道有效信号(`vld_ch`)生成逻辑
- 验证数据计数(`data_count`)计算逻辑
- 验证边界条件处理能力
- 验证模块对随机输入的鲁棒性

## 3. 测试用例

| 测试用例名称 | 描述 | 输入数据 | 关键检查点 | 预期结果 |
|--------------|------|----------|------------|----------|
| **固定模式测试1** | 固定数据A5模式+长度8 | `{128'hA5A5..., 8'hFF, 4'd8}` | 格雷码转换、有效通道、数据计数 | DUT与参考模型输出一致 |
| **固定模式测试2** | 固定数据5A模式+长度4 | `{128'h5A5A..., 8'hAA, 4'd4}` | 长度处理、有效通道映射 | DUT与参考模型输出一致 |
| **长度遍历测试** | 长度值0-15遍历测试 | `{random128, random8, i[3:0]}` (i=0-15) | 各长度值下的数据计数 | 计数与长度值匹配 |
| **全零输入测试** | 输入全零数据 | `140'd0` | 格雷码输出、有效通道 | 输出全零 |
| **全一输入测试** | 输入全一数据 | `140'hFFFF...` | 格雷码转换、数据计数 | 正确转换全1数据 |
| **中间字节位测试** | 中间字节位遍历 | `data[11:4] = (1<<i)` (i=0-7) | 有效通道信号 | 通道位正确映射 |
| **中间字节全通** | 中间字节全FF | `data[11:4]=8'hFF` | 有效通道信号 | 所有通道有效 |
| **随机数据测试** | 50次随机输入 | `{$random, $random, $random}` | 所有输出一致性 | DUT与参考模型一致 |
| **快速变化测试** | 高速输入变化 | 20次随机输入(#1延时) | 输出稳定性 | 无错误响应 |
| **混合数据测试** | 5555/AAAA模式 | `{128'h5555..., random8, 4'd8}` | 特定模式转换 | 正确转换交替模式 |

## 4. 输入数据结构
```plaintext
140位输入分解：
[139:12] : 128位原始数据
[11:4]   : 8位通道/控制信息
[3:0]    : 4位数据长度
```

## 5. 输出信号说明
| 信号 | 位宽 | 描述 |
|------|------|------|
| `data_gray` | 128位 | 格雷码转换后的数据 |
| `vld_ch` | 8位 | 通道有效信号（每比特代表一个通道） |
| `data_count` | 16位 | 有效数据计数 |

## 6. 检查机制
- **实时比对**：输入变化后10ns检查所有输出
- **三重检查**：
  1. `vld_ch`通道有效信号
  2. `data_count`数据计数
  3. `data_gray`格雷码数据
- **错误处理**：检测到差异立即终止测试并打印：
  - 当前仿真时间
  - 错误信号类型
  - DUT输出值
  - 参考模型输出值
  - 当前输入数据

## 7. 测试数据生成策略
| 数据类型 | 生成方式 | 测试重点 |
|----------|----------|----------|
| 固定模式 | 预定义模式(A5,5A,55,AA) | 基础转换逻辑 |
| 边界值 | 全0/全1输入 | 边界处理能力 |
| 长度变化 | 0-15遍历 | 长度适应能力 |
| 通道控制 | 位遍历(1<<i) | 通道映射关系 |
| 随机数据 | `$random`函数 | 鲁棒性测试 |

## 8. 通过标准
- 所有测试用例执行完毕
- 无任何ERROR信息打印
- 最终显示"All tests passed successfully!"消息
- 波形文件完整记录所有测试场景

## 9. 风险分析
| 风险点 | 缓解措施 |
|--------|----------|
| 长度字段超范围 | 已包含0-15全范围测试 |
| 格雷码转换错误 | 多模式数据验证(全0,全1,交替模式) |
| 通道映射错误 | 位遍历测试覆盖所有通道 |
| 时序问题 | 包含高速变化测试(#1延时) |
| 复位状态未测试 | 建议增加复位机制测试 |

## 10. 交付物
1. 验证报告（包含通过率统计）
2. 覆盖率报告